const $=Math.min,_=Math.max,R=Math.round,E=Math.floor,x=t=>({x:t,y:t});function q(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function B(t){return H(t)?(t.nodeName||"").toLowerCase():"#document"}function h(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function V(t){var e;return(e=(H(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function H(t){return t instanceof Node||t instanceof h(t).Node}function N(t){return t instanceof Element||t instanceof h(t).Element}function S(t){return t instanceof HTMLElement||t instanceof h(t).HTMLElement}function A(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof h(t).ShadowRoot}function W(t){const{overflow:e,overflowX:n,overflowY:o,display:i}=T(t);return/auto|scroll|overlay|hidden|clip/.test(e+o+n)&&!["inline","contents"].includes(i)}function U(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function k(t){return["html","body","#document"].includes(B(t))}function T(t){return h(t).getComputedStyle(t)}function K(t){if(B(t)==="html")return t;const e=t.assignedSlot||t.parentNode||A(t)&&t.host||V(t);return A(e)?e.host:e}function I(t){const e=K(t);return k(e)?t.ownerDocument?t.ownerDocument.body:t.body:S(e)&&W(e)?e:I(e)}function C(t,e,n){var o;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=I(t),s=i===((o=t.ownerDocument)==null?void 0:o.body),r=h(i);return s?e.concat(r,r.visualViewport||[],W(i)?i:[],r.frameElement&&n?C(r.frameElement):[]):e.concat(i,C(i,[],n))}function X(t){const e=T(t);let n=parseFloat(e.width)||0,o=parseFloat(e.height)||0;const i=S(t),s=i?t.offsetWidth:n,r=i?t.offsetHeight:o,f=R(n)!==s||R(o)!==r;return f&&(n=s,o=r),{width:n,height:o,$:f}}function D(t){return N(t)?t:t.contextElement}function O(t){const e=D(t);if(!S(e))return x(1);const n=e.getBoundingClientRect(),{width:o,height:i,$:s}=X(e);let r=(s?R(n.width):n.width)/o,f=(s?R(n.height):n.height)/i;return(!r||!Number.isFinite(r))&&(r=1),(!f||!Number.isFinite(f))&&(f=1),{x:r,y:f}}const Y=x(0);function j(t){const e=h(t);return!U()||!e.visualViewport?Y:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function G(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==h(t)?!1:e}function z(t,e,n,o){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=D(t);let r=x(1);e&&(o?N(o)&&(r=O(o)):r=O(t));const f=G(s,n,o)?j(s):x(0);let d=(i.left+f.x)/r.x,l=(i.top+f.y)/r.y,w=i.width/r.x,v=i.height/r.y;if(s){const g=h(s),a=o&&N(o)?h(o):o;let m=g.frameElement;for(;m&&o&&a!==g;){const u=O(m),p=m.getBoundingClientRect(),c=T(m),y=p.left+(m.clientLeft+parseFloat(c.paddingLeft))*u.x,b=p.top+(m.clientTop+parseFloat(c.paddingTop))*u.y;d*=u.x,l*=u.y,w*=u.x,v*=u.y,d+=y,l+=b,m=h(m).frameElement}}return q({width:w,height:v,x:d,y:l})}function J(t,e){let n=null,o;const i=V(t);function s(){clearTimeout(o),n&&n.disconnect(),n=null}function r(f,d){f===void 0&&(f=!1),d===void 0&&(d=1),s();const{left:l,top:w,width:v,height:g}=t.getBoundingClientRect();if(f||e(),!v||!g)return;const a=E(w),m=E(i.clientWidth-(l+v)),u=E(i.clientHeight-(w+g)),p=E(l),y={rootMargin:-a+"px "+-m+"px "+-u+"px "+-p+"px",threshold:_(0,$(1,d))||1};let b=!0;function F(M){const L=M[0].intersectionRatio;if(L!==d){if(!b)return r();L?r(!1,L):o=setTimeout(()=>{r(!1,1e-7)},100)}b=!1}try{n=new IntersectionObserver(F,{...y,root:i.ownerDocument})}catch{n=new IntersectionObserver(F,y)}n.observe(t)}return r(!0),s}function Q(t,e,n,o){o===void 0&&(o={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:r=typeof ResizeObserver=="function",layoutShift:f=typeof IntersectionObserver=="function",animationFrame:d=!1}=o,l=D(t),w=i||s?[...l?C(l):[],...C(e)]:[];w.forEach(c=>{i&&c.addEventListener("scroll",n,{passive:!0}),s&&c.addEventListener("resize",n)});const v=l&&f?J(l,n):null;let g=-1,a=null;r&&(a=new ResizeObserver(c=>{let[y]=c;y&&y.target===l&&a&&(a.unobserve(e),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{a&&a.observe(e)})),n()}),l&&!d&&a.observe(l),a.observe(e));let m,u=d?z(t):null;d&&p();function p(){const c=z(t);u&&(c.x!==u.x||c.y!==u.y||c.width!==u.width||c.height!==u.height)&&n(),u=c,m=requestAnimationFrame(p)}return n(),()=>{w.forEach(c=>{i&&c.removeEventListener("scroll",n),s&&c.removeEventListener("resize",n)}),v&&v(),a&&a.disconnect(),a=null,d&&cancelAnimationFrame(m)}}export{Q as a};
